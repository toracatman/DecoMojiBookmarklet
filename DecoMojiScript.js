(function() {
	var s = prompt("ãƒ†ã‚­ã‚¹ãƒˆ");
	if (s === null) return;
	s = s.replace(/:/g, "ï¼š");

	//æ–‡å­—ï¼ˆæ­£è¦åŒ–å‰ï¼‰
	var c1 = [
		//è¨˜å·
		["ï¼š", "colon"], ["â€¦", "tententen"], ["(ã€œ|ï½)", "wave"],

		//åˆç•¥ä»®å
		["ï½ºã“ã¨ï½³", "koto"], ["(ãƒ¿|ï½ºã‚³ãƒˆï½³)", "koto2"],
		["ï½ºã¨ã‚‚ï½³", "tomo"], ["(ğªœˆ|ï½ºãƒˆãƒ¢ï½³)", "tomo2"],
		["ï½ºãªã‚Šï½³", "nari"]
	];

	//æ–‡å­—ï¼ˆæ­£è¦åŒ–å¾Œï¼‰
	var c2 = [
		//ASCIIè¨˜å·
		["!\\?", "interrobang_mark"],
		["!", "exclamation_mark"],
		["\\(", "kkb"],
		["\\)", "kka"],
		["\\+", "plus"],
		["\\?", "question_mark"],

		//éASCIIè¨˜å·
		["â‰¡", "hamburger_icon"],
		["ã€", "ten"], ["ã€‚", "maru"],
		["ãƒ»", "middle_dot"], ["ãƒ¼", "prolong"],

		//æ‹¡å¼µã‹ãƒŠæ–‡å­—
		["ã„(ãƒ|ã‚£)", "yi"], ["ã„(ã‡|ã‚§)", "ye"], ["ã†ãƒ", "wi"], ["ã†(ã…|ã‚¥)", "wu"], ["ã†ã‡", "we"], ["ã†ã‰", "wo"],
		["ã‚¤ã‚£", "yi2"], ["ã‚¤ã‚§", "ye2"], ["ã‚¦ã‚£", "wi2"], ["ã‚¦ã‚¥", "wu2"], ["ã‚¦ã‚§", "we2"], ["ã‚¦ã‚©", "wo2"],

		//ã²ã‚‰ãŒãª
		["ã‚”", "vu"],
		["ã‚", "a"], ["ã„", "i"], ["ã†", "u"], ["ãˆ", "e"], ["ãŠ", "o"],
		["ã", "la"], ["ãƒ", "li"], ["ã…", "lu"], ["ã‡", "le"], ["ã‰", "lo"],
		["ã‹", "ka"], ["ã", "ki"], ["ã", "ku"], ["ã‘", "ke"], ["ã“", "ko"],
		["ãŒ", "ga"], ["ã", "gi"], ["ã", "gu"], ["ã’", "ge"], ["ã”", "go"],
		["ã•", "sa"], ["ã—", "shi"], ["ã™", "su"], ["ã›", "se"], ["ã", "so"],
		["ã–", "za"], ["ã˜", "zi"], ["ãš", "zu"], ["ãœ", "ze"], ["ã", "zo"],
		["ãŸ", "ta"], ["ã¡", "ti"], ["ã¤", "tsu"], ["ã¦", "te"], ["ã¨", "to"],
		["ã£", "ltsu"],
		["ã ", "da"], ["ã¢", "di"], ["ã¥", "du"], ["ã§", "de"], ["ã©", "do"],
		["ãª", "na"], ["ã«", "ni"], ["ã¬", "nu"], ["ã­", "ne"], ["ã®", "no"],
		["ã¯", "ha"], ["ã²", "hi"], ["ãµ", "fu"], ["ã¸", "he"], ["ã»", "ho"],
		["ã°", "ba"], ["ã³", "bi"], ["ã¶", "bu"], ["ã¹", "be"], ["ã¼", "bo"],
		["ã±", "pa"], ["ã´", "pi"], ["ã·", "pu"], ["ãº", "pe"], ["ã½", "po"],
		["ã¾", "ma"], ["ã¿", "mi"], ["ã‚€", "mu"], ["ã‚", "me"], ["ã‚‚", "mo"],
		["ã‚„", "ya"], ["ğ›€†", "yi"], ["ã‚†", "yu"], ["ğ›€", "ye"], ["ã‚ˆ", "yo"],
		["ã‚ƒ", "lya"], ["ã‚…", "lyu"], ["ã‚‡", "lyo"],
		["ã‚‰", "ra"], ["ã‚Š", "ri"], ["ã‚‹", "ru"], ["ã‚Œ", "re"], ["ã‚", "ro"],
		["ã‚", "wa"], ["ã‚", "wi"], ["ğ›„Ÿ", "wu"], ["ã‚‘", "we"], ["ã‚’", "wo"],
		["ã‚“", "n"],

		//ã‚«ã‚¿ã‚«ãƒŠ
		["ã‚¢ã‚™", "a2d"], ["ã‚¤ã‚™", "i2d"], ["ãƒ´", "vu2"], ["ã‚¨ã‚™", "e2d"], ["ã‚ªã‚™", "o2d"],
		["ã‚¢", "a2"], ["ã‚¤", "i2"], ["ã‚¦", "u2"], ["ã‚¨", "e2"], ["ã‚ª", "o2"],
		["ã‚¡", "xa2"], ["ã‚£", "xi2"], ["ã‚¥", "xu2"], ["ã‚§", "xe2"], ["ã‚©", "xo2"],
		["ã‚«", "ka2"], ["ã‚­", "ki2"], ["ã‚¯", "ku2"], ["ã‚±", "ke2"], ["ã‚³", "ko2"],
		["ã‚¬", "ga2"], ["ã‚®", "gi2"], ["ã‚°", "gu2"], ["ã‚²", "ge2"], ["ã‚´", "go2"],
		["ã‚µ", "sa2"], ["ã‚·", "si2"], ["ã‚¹", "su2"], ["ã‚»", "se2"], ["ã‚½", "so2"],
		["ã‚¶", "za2"], ["ã‚¸", "zi2"], ["ã‚º", "zu2"], ["ã‚¼", "ze2"], ["ã‚¾", "zo2"],
		["ã‚¿", "ta2"], ["ãƒ", "ti2"], ["ãƒ„", "tu2"], ["ãƒ†", "te2"], ["ãƒˆ", "to2"],
		["ãƒƒ", "xtu2"],
		["ãƒ€", "da2"], ["ãƒ‚", "di2"], ["ãƒ…", "du2"], ["ãƒ‡", "de2"], ["ãƒ‰", "do2"],
		["ãƒŠ", "na2"], ["ãƒ‹", "ni2"], ["ãƒŒ", "nu2"], ["ãƒ", "ne2"], ["ãƒ", "no2"],
		["ãƒ", "ha2"], ["ãƒ’", "hi2"], ["ãƒ•", "hu2"], ["ãƒ˜", "he2"], ["ãƒ›", "ho2"],
		["ãƒ", "ba2"], ["ãƒ“", "bi2"], ["ãƒ–", "bu2"], ["ãƒ™", "be2"], ["ãƒœ", "bo2"],
		["ãƒ‘", "pa2"], ["ãƒ”", "pi2"], ["ãƒ—", "pu2"], ["ãƒš", "pe2"], ["ãƒ", "po2"],
		["ãƒ", "ma2"], ["ãƒŸ", "mi2"], ["ãƒ ", "mu2"], ["ãƒ¡", "me2"], ["ãƒ¢", "mo2"],
		["ãƒ¤", "ya2"], ["ğ›„ ", "yi2"], ["ãƒ¦", "yu2"], ["ğ›„¡", "ye2"], ["ãƒ¨", "yo2"],
		["ãƒ£", "xya2"], ["ãƒ¥", "xyu2"], ["ãƒ§", "xyo2"],
		["ãƒ©", "ra2"], ["ãƒª", "ri2"], ["ãƒ«", "ru2"], ["ãƒ¬", "re2"], ["ãƒ­", "ro2"],
		["ãƒ¯", "wa2"], ["ãƒ°", "wi2"], ["ğ›„¢", "wu2"], ["ãƒ±", "we2"], ["ãƒ²", "wo2"],
		["ãƒ³", "n2"]
	];

	//æ•°å­—ã€å°æ–‡å­—
	s = s.replace(/(\d)/g, ":_$1:")
		.replace(/([a-z])/g, ":_$14:");

	//å¤§æ–‡å­—
	var r;
	while ((r = /([A-Z])/.exec(s)) !== null) {
		s = s.replace(r[1], `:_${r[1].toLowerCase()}3:`);
	}

	//æ–‡å­—ï¼ˆæ­£è¦åŒ–å‰ï¼‰
	for (var i = 0; i < c1.length; i++) {
		s = s.replace(new RegExp(c1[i][0], "gu"), `:_${c1[i][1]}:`);
	}

	//æ­£è¦åŒ–
	s = s.replace(/ã‚›/g, "ã‚™").replace(/ã‚œ/g, "ã‚š");
	s = s.normalize("NFKC");

	//æ–‡å­—ï¼ˆæ­£è¦åŒ–å¾Œï¼‰
	for (var i = 0; i < c2.length; i++) {
		s = s.replace(new RegExp(c2[i][0], "gu"), `:_${c2[i][1]}:`);
	}

	s = s.replace(/ /g, "ã€€");	//å…¨è§’ã‚¹ãƒšãƒ¼ã‚¹ã«ã™ã‚‹

	//å‡ºåŠ›
	var a = document.querySelector("textarea[data-cy-post-form-text]");
	var ss = a.selectionStart;
	var se = a.selectionEnd;
	a.value = `${a.value.slice(0, ss)}${s}${a.value.slice(se)}`;
	var ns = ss + s.length;
	a.setSelectionRange(ns, ns);
	a.focus();
	a.dispatchEvent(new Event("input"));
})();